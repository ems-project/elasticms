{% extends '@EMSCH/template/variables.twig' %}
{% set rawData = section|emsch_get.source %}
{% set paths = rawData.paths|default([])|filter(p => p.locale == locale)|array_key('uid') %}
{% set structure = rawData.structure|default("{}")|ems_json_menu_nested_decode %}
{% set urls = {} %}

{% set baseUrl = '' %}
{% if app.request.server.all['EMSCO_INSTANCE_ID']|default(false) %}
    {% set baseUrl = "/channel/#{trans_default_domain}" %}
{% endif %}

{% for item in structure %}
    {% set pathInfo = attribute(paths, item.id)|default(false) %}
    {% if pathInfo %}
        {% set urls = urls|merge({(item.id): path('emsch_path', {path: pathInfo.path})}) %}
    {% endif %}
{% endfor %}

