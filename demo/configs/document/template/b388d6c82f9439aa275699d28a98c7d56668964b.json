{
    "body": "{% extends '@EMSCH/template/variables.twig' %}\n{% set rawData = section|emsch_get.source %}\n{% set paths = rawData.paths|default([])|filter(p => p.locale == locale)|array_key('uid') %}\n{% set structure = rawData.structure|default(\"{}\")|ems_json_menu_nested_decode %}\n{% set urls = {} %}\n\n{% set baseUrl = '' %}\n{% if app.request.server.all['EMSCO_INSTANCE_ID']|default(false) %}\n    {% set baseUrl = \"/channel/#{trans_default_domain}\" %}\n{% endif %}\n\n{% set sections = emsch_search('section', {\n    query: {\n        terms: {\n            _contenttype: ['section'],\n        },\n    },\n    _source: ['label', 'menu', 'structure', 'paths'],\n    size: 100,\n}).hits.hits|default([])|filter(p => p._source.menu|default(false))|map(p => {\n    id: p._id,\n    contenttype: p._source._contenttype,\n    label: p._source.label,\n    menu: p._source.menu,\n    structure: p._source.structure,\n    paths: p._source.paths|default([]),\n})|array_key('menu') %}\n\n\n\n{% set pages = emsch_search('page', {\n    query: {\n        terms: {\n            _contenttype: ['page'],\n        },\n    },\n    _source: ['menu'],\n    size: 1000,\n}).hits.hits|default([])|map(p => p._source.menu) %}\n\n\n{% for item in structure %}\n    {% set pathInfo = attribute(paths, item.id)|default(false) %}\n    {% if pathInfo %}\n        {% set urls = urls|merge({(item.id): path('emsch_path', {path: pathInfo.path})}) %}\n    {% endif %}\n    {% if item.type == 'section' and attribute(sections, item.id) %}\n        {% set paths = paths|merge(attribute(sections, item.id).paths|filter(p => p.locale == locale)|array_key('uid')) %}\n        {% do item.setChildren(attribute(sections, item.id).structure|default('{}')|ems_json_menu_nested_decode.children) %}\n    {% endif %}\n{% endfor %}\n\n",
    "name": "fragments/structure.html.twig"
}