{
    "body": "{% extends '@EMSCH/template/variables.twig' %}\n\n{#{%  if emsLink is defined %}#}\n{#    {% set locales = app.request.server.all['EMSCH_LOCALES']|default('[]')|ems_json_decode %}#}\n{#    {% set contentTypeWithMissingTranslation = ['page'] %}#}\n\n{#    {% if emsLink.contentType|default(null) in ['structure'] %}#}\n{#        {% set link = \"ems://object:#{target.contentType}:#{target.ouuid}\" %}#}\n{#        {% set ouuid = target.ouuid %}#}\n{#    {% else %}#}\n{#        {% set link = emsLink.__toString() %}#}\n{#        {% set ouuid = emsLink.ouuid %}#}\n{#    {% endif %}#}\n\n{#    {% set canonicalUrls = {} %}#}\n{#    {% for locale in locales %}#}\n{#        {% set canonicalUrls = canonicalUrls|merge({#}\n{#            (locale): link|emsch_routing(locale, app.request.getBaseUrl),#}\n{#        }) %}#}\n{#    {% endfor %}#}\n\n{#    {% set canonicalUrl = app.request.getSchemeAndHttpHost()~attribute(canonicalUrls, app.request.locale) %}#}\n{#    {% set canonicalUrls = canonicalUrls|default([])|filter((u, l) => l != app.request.locale and u != link|default(''))|map(u => app.request.getSchemeAndHttpHost()~u) %}#}\n{#    {% set switchUrls = canonicalUrls|filter((u,l) => source._contenttype in contentTypeWithMissingTranslation or attribute(source, l).show|default(false)) %}#}\n{#{% endif %}#}\n",
    "name": "base/canonicals.twig"
}